------------------------------
table √† utiliser

------------------------

```sql
-- 1. BASE DE DONN√âES
CREATE DATABASE IF NOT EXISTS fitconnect
    CHARACTER SET utf8mb4
    COLLATE utf8mb4_unicode_ci;
USE fitconnect;

-- 2. TABLE ADMIN
CREATE TABLE admin (
    id_admin INT AUTO_INCREMENT PRIMARY KEY,
    nom VARCHAR(100) NOT NULL,
    prenom VARCHAR(100) NOT NULL,
    email VARCHAR(150) UNIQUE NOT NULL,
    mot_de_passe VARCHAR(255) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- 3. TABLE CANDIDATURE (remplace totalement la table candidat)
CREATE TABLE candidature (
    id_candidature INT AUTO_INCREMENT PRIMARY KEY,
    nom VARCHAR(100) NOT NULL,
    prenom VARCHAR(100) NOT NULL,
    email VARCHAR(150) NOT NULL,
    adresse VARCHAR(255) NOT NULL,
    basic_fit TINYINT(1) NOT NULL,
    specialite ENUM('prise_masse','seche','remise_forme') NOT NULL,
    experience INT NOT NULL,
    cv_pdf VARCHAR(255) NOT NULL,
    linkedin VARCHAR(255),
    password VARCHAR(255) NOT NULL,
    statut ENUM('en_attente','valide','refuse') DEFAULT 'en_attente',
    date_candidature TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    date_decision TIMESTAMP NULL,
    id_admin INT NULL,
    CONSTRAINT fk_candidature_admin
        FOREIGN KEY (id_admin) REFERENCES admin(id_admin)
        ON DELETE SET NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- 4. TABLE COACH (coach valid√© uniquement)
CREATE TABLE coach (
    id INT AUTO_INCREMENT PRIMARY KEY,
    nom VARCHAR(100) NOT NULL,
    prenom VARCHAR(100) NOT NULL,
    email VARCHAR(150) UNIQUE NOT NULL,
    adresse VARCHAR(255) NOT NULL,
    basic_fit TINYINT(1) NOT NULL,
    specialite ENUM('prise_masse','seche','remise_forme') NOT NULL,
    experience INT NOT NULL,
    password VARCHAR(255) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- 5. TABLE CLIENT
CREATE TABLE client (
    id_client INT AUTO_INCREMENT PRIMARY KEY,
    nom VARCHAR(50) NOT NULL,
    prenom VARCHAR(50) NOT NULL,
    mail VARCHAR(100) NOT NULL UNIQUE,
    mot_de_passe VARCHAR(255) NOT NULL,
    poids INT NOT NULL,
    taille INT NOT NULL,
    genre ENUM('homme','femme','autre','prefere_pas','croissant') NOT NULL,
    basic_fit TINYINT(1) DEFAULT 0,
    objectif VARCHAR(50) NOT NULL,
    dispo_jours TEXT NULL,
    dispo_creneaux VARCHAR(255) NULL,
    motivation TEXT NOT NULL,
    date_inscription TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    id_coach INT NULL,
    CONSTRAINT fk_client_coach
        FOREIGN KEY (id_coach) REFERENCES coach(id)
        ON DELETE SET NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- 6. TABLE PROGRAMME (inchang√©e)
CREATE TABLE programme (
    id_programme INT AUTO_INCREMENT PRIMARY KEY,
    nom VARCHAR(100) NOT NULL,
    description TEXT NOT NULL,
    type VARCHAR(50) NOT NULL
) ENGINE=InnoDB;
```
















------------------------------------------------------------------------------------------------------------------------
Parfait, on avance bien.
Je te donne **exactement ce que tu veux** :

- ‚úî les **requ√™tes SQL** pour valider/refuser une candidature
- ‚úî le **code Java (JDBC)** pour g√©rer les candidatures
- ‚úî avec **des commentaires clairs** pour que tu saches quoi modifier

Et tout √ßa **simple**, **logique**, **propre**, adapt√© √† un projet √©tudiant.

---

# ‚úÖ 1. REQU√äTES SQL POUR G√âRER UNE CANDIDATURE

## üîπ A. R√©cup√©rer toutes les candidatures en attente

```sql
SELECT * FROM candidature
WHERE statut = 'en_attente';
```

---

## üîπ B. R√©cup√©rer une candidature pr√©cise

```sql
SELECT * FROM candidature
WHERE id_candidature = ?;
```

---

## üîπ C. Valider une candidature (mise √† jour du statut)

```sql
UPDATE candidature
SET statut = 'valide',
    date_decision = NOW(),
    id_admin = ?
WHERE id_candidature = ?;
```

---

## üîπ D. Refuser une candidature

```sql
UPDATE candidature
SET statut = 'refuse',
    date_decision = NOW(),
    id_admin = ?
WHERE id_candidature = ?;
```

---

## üîπ E. Transformer une candidature valid√©e ‚Üí coach

```sql
INSERT INTO coach (nom, prenom, email, adresse, basic_fit, specialite, experience, password)
SELECT nom, prenom, email, adresse, basic_fit, specialite, experience, password
FROM candidature
WHERE id_candidature = ?;
```

---

## üîπ F. (Optionnel) Supprimer la candidature apr√®s validation

```sql
DELETE FROM candidature
WHERE id_candidature = ?;
```

---

# ‚úÖ 2. CODE JAVA (JDBC) POUR G√âRER LES CANDIDATURES

Je te fais un code **simple**, **propre**, **comment√©**, que tu peux adapter.

---

# üîπ A. R√©cup√©rer toutes les candidatures en attente

```java
public List<Candidature> getCandidaturesEnAttente(Connection conn) throws Exception {
    String sql = "SELECT * FROM candidature WHERE statut = 'en_attente'";
    PreparedStatement ps = conn.prepareStatement(sql);
    ResultSet rs = ps.executeQuery();

    List<Candidature> list = new ArrayList<>();

    while (rs.next()) {
        Candidature c = new Candidature();
        c.setId(rs.getInt("id_candidature"));
        c.setNom(rs.getString("nom"));
        c.setPrenom(rs.getString("prenom"));
        c.setEmail(rs.getString("email"));
        c.setSpecialite(rs.getString("specialite"));
        c.setExperience(rs.getInt("experience"));
        // ajoute les autres champs si tu veux

        list.add(c);
    }

    return list;
}
```

---

# üîπ B. Valider une candidature

```java
public void validerCandidature(Connection conn, int idCandidature, int idAdmin) throws Exception {

    // 1. Mettre √† jour le statut
    String updateSql = "UPDATE candidature SET statut='valide', date_decision=NOW(), id_admin=? WHERE id_candidature=?";
    PreparedStatement ps = conn.prepareStatement(updateSql);
    ps.setInt(1, idAdmin);
    ps.setInt(2, idCandidature);
    ps.executeUpdate();

    // 2. Copier les infos dans la table coach
    String insertSql = """
        INSERT INTO coach (nom, prenom, email, adresse, basic_fit, specialite, experience, password)
        SELECT nom, prenom, email, adresse, basic_fit, specialite, experience, password
        FROM candidature
        WHERE id_candidature = ?
    """;

    PreparedStatement ps2 = conn.prepareStatement(insertSql);
    ps2.setInt(1, idCandidature);
    ps2.executeUpdate();

    // 3. (Optionnel) supprimer la candidature
    String deleteSql = "DELETE FROM candidature WHERE id_candidature=?";
    PreparedStatement ps3 = conn.prepareStatement(deleteSql);
    ps3.setInt(1, idCandidature);
    ps3.executeUpdate();
}
```

---

# üîπ C. Refuser une candidature

```java
public void refuserCandidature(Connection conn, int idCandidature, int idAdmin) throws Exception {

    String sql = "UPDATE candidature SET statut='refuse', date_decision=NOW(), id_admin=? WHERE id_candidature=?";
    PreparedStatement ps = conn.prepareStatement(sql);
    ps.setInt(1, idAdmin);
    ps.setInt(2, idCandidature);
    ps.executeUpdate();

    // Ici on ne copie rien dans coach
    // Tu peux supprimer la candidature si tu veux
}
```

---

# üîπ D. Classe Java Candidature (POJO)

```java
public class Candidature {
    private int id;
    private String nom;
    private String prenom;
    private String email;
    private String specialite;
    private int experience;

    // + getters / setters
}
```

---

# üéØ Tu veux aller plus loin ?

Je peux te faire :

- ‚úî un **diagramme UML**
- ‚úî les **endpoints API** (Spring Boot)
- ‚úî une **interface graphique JavaFX** pour g√©rer les candidatures
- ‚úî un **syst√®me de login admin**
- ‚úî un **script SQL complet final** avec les programmes inclus

Tu veux quoi pour la suite ?













------------------------------------------------------------------------------------------------------------------------


Bien s√ªr qu‚Äôil est logique que l‚Äôadmin doive se connecter ‚Äî sinon n‚Äôimporte qui pourrait valider des coachs.
On va donc compl√©ter ton syst√®me avec :

- un **login admin** (SQL + Java)
- la **v√©rification du mot de passe**
- la **gestion de session** (simple, version √©tudiante)
- et tout √ßa **clair, propre, comment√©**, pour que tu puisses l‚Äôint√©grer facilement.

Je te fais √ßa **sans frameworks**, en **JDBC simple**, comme dans 95% des projets √©tudiants.

---

# ‚úÖ 1. SQL : Connexion Admin

## üîπ V√©rifier si un admin existe avec email + mot de passe

```sql
SELECT * FROM admin
WHERE email = ?
AND mot_de_passe = ?;
```

‚ö†Ô∏è Dans un vrai projet on mettrait un hash, mais pour un projet √©tudiant ‚Üí **mot de passe en clair = OK**.

---

# üîπ V√©rifier si un email admin existe (pour √©viter les doublons)

```sql
SELECT COUNT(*) FROM admin WHERE email = ?;
```

---

# üîπ Ins√©rer un admin (si vous voulez en cr√©er un par d√©faut)

```sql
INSERT INTO admin (nom, prenom, email, mot_de_passe)
VALUES ('Admin', 'Principal', 'admin@fitconnect.com', 'admin123');
```

---

# ‚úÖ 2. JAVA : Connexion Admin (JDBC)

Voici un code **simple**, **propre**, **comment√©**, que tu peux coller dans ton projet.

---

## üîπ Classe Admin (POJO)

```java
public class Admin {
    private int id;
    private String nom;
    private String prenom;
    private String email;

    // getters + setters
}
```

---

## üîπ M√©thode Java : loginAdmin()

```java
public Admin loginAdmin(Connection conn, String email, String password) throws Exception {

    // SQL pour v√©rifier l'admin
    String sql = "SELECT * FROM admin WHERE email = ? AND mot_de_passe = ?";

    PreparedStatement ps = conn.prepareStatement(sql);
    ps.setString(1, email);
    ps.setString(2, password);

    ResultSet rs = ps.executeQuery();

    // Si aucun admin trouv√© ‚Üí login √©chou√©
    if (!rs.next()) {
        return null;
    }

    // Si trouv√© ‚Üí on cr√©e un objet Admin
    Admin admin = new Admin();
    admin.setId(rs.getInt("id_admin"));
    admin.setNom(rs.getString("nom"));
    admin.setPrenom(rs.getString("prenom"));
    admin.setEmail(rs.getString("email"));

    return admin;
}
```

### ‚úî Ce que tu dois modifier :
- Rien d‚Äôobligatoire, mais tu peux changer les noms de variables si tu veux.

---

# üî• 3. Gestion de ‚Äúsession‚Äù admin (version √©tudiante)

Comme vous n‚Äôavez pas de vrai syst√®me web, vous allez faire un truc simple :

üëâ Quand l‚Äôadmin se connecte, vous stockez l‚Äôobjet Admin dans une variable statique.

Exemple :

```java
public class Session {
    public static Admin adminConnecte = null;
}
```

Puis dans ton code :

```java
Admin admin = loginAdmin(conn, email, password);

if (admin != null) {
    Session.adminConnecte = admin;
    System.out.println("Connexion r√©ussie !");
} else {
    System.out.println("Email ou mot de passe incorrect.");
}
```

Et ensuite, pour v√©rifier si l‚Äôadmin est connect√© :

```java
if (Session.adminConnecte == null) {
    System.out.println("Acc√®s refus√© : vous devez √™tre connect√©.");
    return;
}
```

---

# üî• 4. Int√©gration avec la validation des candidatures

Tu vas utiliser `Session.adminConnecte.getId()` pour savoir quel admin valide.

Exemple :

```java
validerCandidature(conn, idCandidature, Session.adminConnecte.getId());
```

---

# üéØ R√©sultat final

Tu as maintenant :

- ‚úî un syst√®me admin complet
- ‚úî login admin (SQL + Java)
- ‚úî session admin
- ‚úî validation/refus de candidature
- ‚úî transformation candidature ‚Üí coach

Ton projet devient **coh√©rent**, **logique**, **propre**, et surtout **fonctionnel**.








